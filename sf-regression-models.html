<!DOCTYPE html>
<html lang="[zh]">
<head>
	<link rel="stylesheet" type="text/css" href="/theme/css/style.css">
	<!--<link rel="stylesheet/less" type="text/css" href="/theme/css/style.less">-->
	<!--<script src="/theme/js/less.js" type="text/javascript"></script>-->
	<link rel="stylesheet" type="text/css" href="/theme/css/pygments.css">
	<link rel="stylesheet" type="text/css" href="/theme/css/ydSetting.css">
	<link href='//fonts.googleapis.com/css?family=Open+Sans:800,400,300|Inconsolata' rel='stylesheet' type='text/css'>
  <link rel="shortcut icon" href="./ico/apple-touch-icon.png">
	<link href="aady5566.github.io/" type="application/atom+xml" rel="alternate" title="5566 ATOM Feed" />


		<title>5566</title>
		<meta charset="utf-8" />
</head>
<body>
	<section id="sidebar">
		<figure id="user_logo">
            <!-- <a href=""><div class="logo">&nbsp;</div></a> -->
						<img class="circular" src="https://raw.githubusercontent.com/aady5566/aady5566.github.io/master/pic/yd_fbas.jpg">
		</figure>
	</br>
		<div class="user_meta">
            <h1 id="user"><a href="http://aady5566.github.io" class="">YD</a></h1>
			<h2></h2>
			<p class="bio">lives in a cave.</p>
			<ul>
					<li><a href="http://aady5566.github.io/timeline/" target="_blank">timeline</a></li>
					<li><a href="http://aady5566.bitbucket.org/" target="_blank">@_yd</a></li>
					<li><a href="https://tw.linkedin.com/in/yd-huang-735358aa" target="_blank">linkedin</a></li>
					<li><a href="https://github.com/aady5566" target="_blank">github</a></li>
					<li><a href="mailto:ydhuang@ntu.edu.tw" target="_blank">mail</a></li>
			</ul>
		</div>
		<footer>
			<address>
				&copy 2016 YD <br> Powered by Pelican.
			</address>
		</footer>
	</section>

	<section id="posts">
	<header>
		<h1>YD's blog</h1>
		<nav id="header-nav">
				<a id="header-nav-item"  href="/archives.html">Archives</a>
				<a id="header-nav-item"  href="/categories.html">Categories</a>
				<a id="header-nav-item"  href="/tags.html">Tags</a>
		</nav>
		<h3 id="date">Posted 三 15 3月 2017</h3>
	</header>
	<article>
		<h1 id="title">
			<a href="/sf-regression-models.html" rel="bookmark"
				title="Permalink to SF Regression Models">SF Regression Models</a>
		</h1>
		<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=default">
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [ ['$','$'], ['\\(','\\)'] ]
  }
});
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-77164531-1', 'auto');
ga('send', 'pageview');
</script>

<h1>CH2. Regression Models</h1>
<h2>Regression Function</h2>
<p>類似邊際函數的概念
$f(x) =  E( Y | X = x )$ 理想上應要能用一個數學式表達這個世間的現象，不過因為有系統誤差，我們保守改寫為
$Y = f(x) + error$</p>
<div class="img">
<img src="https://d2mxuefqeaa7sj.cloudfront.net/s_E951995ED296F27BFD79463903ABDFDDBDB80109E611EA24979BBEE8CD74A837_1479051604759_+2016-11-13+11.36.15.png
" width="80%" height="80%" />       
</div>

<p>也就是我們期待找到一個 $g(X)$ 使得所有的 $X = x$ 代入  $[Y-g(X)]^2$ 得到最小的值。其實就是在算 mean square error: $\frac{1}{n} \sum_{i=1}^{n}(Y - g(X))^2$ （等於下圖的公式），此值越小越好。</p>
<div class="img">
<img src="https://d2mxuefqeaa7sj.cloudfront.net/s_E951995ED296F27BFD79463903ABDFDDBDB80109E611EA24979BBEE8CD74A837_1479051954790_+2016-11-13+11.45.43.png
" width="80%" height="80%" />       
</div>

<div class="img">
<img src="https://d2mxuefqeaa7sj.cloudfront.net/s_E951995ED296F27BFD79463903ABDFDDBDB80109E611EA24979BBEE8CD74A837_1479053559389_+2016-11-14+12.09.45.png
" width="80%" height="80%" />       
</div>

<p>我們真正在解的 $g(X)$ 其實就是上述的 $\hat{f}(x)$ ，找出最佳估計理想中的 $f(x)$ 
下面的例子是以 nearest neighbor averaging 作為 $\hat{f}(x)$ 為例</p>
<div class="img">
<img src="https://d2mxuefqeaa7sj.cloudfront.net/s_E951995ED296F27BFD79463903ABDFDDBDB80109E611EA24979BBEE8CD74A837_1479053700817_+2016-11-14+12.14.45.png
" width="80%" height="80%" />       
</div>

<h1>2.2</h1>
<p><strong>the curse of dimensionality</strong>
多維度的 $x$  neighborhood 會讓區間變大，意即失準</p>
<p>為解決這問題，就需要有結構性的模型，最簡單的例子就是線性模型。</p>
<p><strong>trade-off</strong>
Prediction accuracy vs. interpretability
Good fit vs. over-fit vs. under-fit
Parsimony vs. blackbox: 用少量的參數簡單的模型還是參數複雜的模型</p>
<h1>2.3</h1>
<p>mean square error: 每個訓練集代入模型後與實際結果的差異
$MSE = AVG[y_i - \hat{f}(x_i)]^2$
其中又可以細分 訓練集的 $MSE_{TR}$ 及 測試集的 $MSE_{TE}$，我們可以利用這兩個指標（又尤其後者）來衡量模型的好壞。
這裡要特別提到 variance 和 bias ，公式說明如下：
假設真實世界中存在一條真理為：</p>
<p>$Y=f(X)+\epsilon$ （ $\epsilon$ 為 隨機誤差） </p>
<p>而我們現實世界能得到的為：</p>
<p>$\hat{f}(x)$ （ $x$ 為實際取得的資料點）</p>
<p>則我們得到的 expected prediction error 可以表示成：</p>
<div class="img">
<img src="https://d2mxuefqeaa7sj.cloudfront.net/s_E951995ED296F27BFD79463903ABDFDDBDB80109E611EA24979BBEE8CD74A837_1480332160214_+2016-11-28+7.19.37.png
" width="80%" height="80%" />       
</div>

<p><strong>Variance</strong>: $Var(\hat{f}(x_0))$ 是來自 不同的訓練集所生成的不同 $\hat{f}()$ 帶入相同的觀察點 $x_0$ 所產生的變異量，也就是信度。
<strong>Bias</strong>: $[Bias(\hat{f}(x_0))]^2 = [f(x_0)-E(\hat{f}(x_0))]^2$ ，為真理與模型期望的差距，也就是效度。
就應用面而言，我們比較不在意訓練集的誤差有多大，我們在意的是測試集的誤差（也就是預期結果），但這兩者相輔相成。依照上述的公式，可以得到下面的結論：</p>
<ol>
<li>彈性越大的模型，越容易受到訓練集的影響而生成差異大的 $\hat{f}()$ 而導致 variance 大</li>
<li>彈性越大的模型，通常參數越多，也往往$MSE_{TR}$ 越小（但也不一定，最極端的例子就是 predictor 本身就是 y 或是一堆 random predictor ）</li>
<li>彈性越大的模型，越可能符合真理，也就是效度較高，Bias 較小。</li>
<li>無論是 <em>variance</em> 或是 <em>bias</em> ，兩者我們稱為 <em>reducible error</em>。（也就是人為可控制的因素）</li>
</ol>
<h1>2.4</h1>
<p>classification problem: 找出最佳的 $C(X)$
假設有 $1,...,K$ 個分類，則觀察值 $x$ 在每個分類的機率為  $p_k(x)=Pr(Y=k|X=x), k= 1,...K$
而 Bayes Optimal 就是找出在已知的觀察值下，最大的可能分類為何：  </p>
<p>$C(x)=j,\;if \; p_j(x) = max{\;p_1(x),...p_K(x)\;}$</p>
<h1>2.7</h1>
<p>A flexible model will allow us to take full advantage of our large sample size.
when $Var(\epsilon)$ is extremely high: A flexible model will cause us to <strong>fit too much of the noise</strong> in the problem.</p>
<div id="disqus_thread"></div>

<script>
    /**
     *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
     *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
     */
    /*
    var disqus_config = function () {
        this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
        this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
    */
    (function() {  // DON'T EDIT BELOW THIS LINE
        var d = document, s = d.createElement('script');

        s.src = '//aady5566github.disqus.com/embed.js';

        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>

		<div id="article_meta">
				Category:
					<a href="/category/stat.html">Stat</a>
				<br />Tags:
					<a href="/tag/stat.html">Stat</a>
		</div>
	</article>

	<footer>
		<a href="/" class="button_accent">&larr;&nbsp;&nbsp;&nbsp;Back to blog</a>
	</footer>


	</section>

</body>
</html>